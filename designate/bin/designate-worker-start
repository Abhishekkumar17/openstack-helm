#!/usr/bin/env bash

set -e
set -x

. /container.init/common.sh

function process_config {
    cp /designate-etc/designate.conf /etc/designate/designate.conf
    cp /designate-etc/logging.conf /etc/designate/logging.conf
    cp /designate-etc/pools.yaml /etc/designate/pools.yaml
    cp /designate-etc/rndc.key /etc/designate/rndc.key
    cp /designate-etc/policy.json  /etc/designate/policy.json

    apply_patches # Apply hot-fixes, which need to be either upstreamed or moved to the container build
}


function start_application {
    exec /var/lib/kolla/venv/bin/designate-worker
}

process_config

start_application
